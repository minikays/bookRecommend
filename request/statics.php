<?php	//连接数据库	$con = mysql_connect("localhost", "root", "ab7df0e4e6");	if (!$con)	{		die('Could not connect: ' . mysql_error());	}	//选择成长轨数据库	$db_selected = mysql_select_db("growthtrack",$con);		//解决中文乱码	$anosql = "set names utf8";	mysql_query($anosql,$con);		//假设需要返回的数据是软件学院当年的填写数据	$department = "软件学院";	$fillYear = date('Y');		//单个数据的信息处理	$sql = "SELECT * from statics where department = '$department' and fillYear = '$fillYear' ";	$result = mysql_query($sql,$con);	$statics = mysql_fetch_array($result,MYSQL_ASSOC);	$totalNum = mysql_num_fields($result); 	$result_field=mysql_list_fields('GrowthTrack','statics',$con);	for ($k=0;$k<$totalNum;$k++){		$field_name=mysql_field_name($result_field,$k);		$arr[$field_name] = $statics["$field_name"];	}		//统计书本排名信息(待改进)	$sql = "SELECT * from info2 where fillYear = '$fillYear' ORDER BY bookNum desc LIMIT 0,19";	$result = mysql_query($sql,$con);	$totalNum = mysql_num_fields($result); 	$result_field=mysql_list_fields('GrowthTrack','info2',$con);	$r = array();	$count = 0;	while($row = mysql_fetch_assoc($result))	{		for ($k=0; $k<$totalNum; $k++)		{			$field_name=mysql_field_name($result_field,$k);			$r[$count][$field_name] = $row["$field_name"];		}		$count++;	}	$arr["bookRank"] = $r;		//游历国家情况统计	$sql = "SELECT country from tour where fillYear = '$fillYear' and department='$department' ";	$result = mysql_query($sql,$con);	$ret = array();	$r = array();	$count = 0;	$tourNum = 0;	while($row = mysql_fetch_assoc($result))	{		$ret[] = $row["country"];	}	$ret = array_count_values($ret);	$arr_cnt = count($ret);	for ($i=0; $i<$arr_cnt; $i++)	{		$key =key($ret);		$r[$i]["country"] = "$key";		$r[$i]["cnt"] = "$ret[$key]";		$tourNum += $ret[$key];		next($ret);	}	$arr["tour"] = $r;	$arr["tourNum"] = $tourNum;			echo json_encode($arr, JSON_UNESCAPED_UNICODE);	mysql_close($con);?>